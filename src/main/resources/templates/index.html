<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Todo List</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        function toggleSearchButton() {
            var button = document.getElementById("searchButton");
            var form = document.getElementById("searchForm");
            if (button.innerText === "Search") {
                if (formSubmitted) {
                    button.innerText = "Back";
                } else {
                    form.submit();
                    formSubmitted = true;
                }
            } else {
                button.innerText = "Search";
                formSubmitted = false;
            }
        }

        var formSubmitted = false;
    </script>
</head>
<body>
<h1 class="text-2xl font-bold mb-4 flex justify-center w-full bg-yellow-200">Todo List</h1>
<div class="flex justify-between items-center mb-4">
    <form id="searchForm" class="flex" action="/todo/search" method="get">
        <input type="text" name="task" placeholder="Search by task" class="mr-2 px-2 py-1 border border-gray-300 rounded">
        <select name="isDone" class="mr-2 px-2 py-1 border border-gray-300 rounded">
            <option value="">All</option>
            <option value="true">Done</option>
            <option value="false">Not Done</option>
        </select>
        <button id="searchButton" type="button" onclick="toggleSearchButton()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Search</button>
    </form>
    <a href="/todo/new" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
        Add New Todo
    </a>
</div>

<table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50">
    <tr class="bg-orange-200">
        <th scope="col" class="px-6 py-3 text-left text-sm font-medium text-gray-700 uppercase tracking-wider">ID</th>
        <th scope="col" class="px-6 py-3 text-left text-sm font-medium text-gray-700 uppercase tracking-wider">Task</th>
        <th scope="col" class="px-6 py-3 text-left text-sm font-medium text-gray-700 uppercase tracking-wider">Description</th>
        <th scope="col" class="px-6 py-3 text-left text-sm font-medium text-gray-700 uppercase tracking-wider">Is Done</th>
        <th scope="col" class="px-6 py-3 text-left text-sm font-medium text-gray-700 uppercase tracking-wider">Created At</th>
        <th scope="col" class="px-6 py-3 text-left text-sm font-medium text-gray-700 uppercase tracking-wider">Actions</th>
    </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
    <tr th:each="todo : ${todos}">
        <td class="px-6 py-4 whitespace-nowrap" th:text="${todo.id}"></td>
        <td class="px-6 py-4 whitespace-nowrap" th:text="${todo.task}"></td>
        <td class="px-6 py-4 whitespace-nowrap" th:text="${todo.description}"></td>
        <td class="px-6 py-4 whitespace-nowrap">
            <input type="checkbox" th:checked="${todo.isDone}" th:attr="checked=${todo.isDone ? 'checked' : null}" disabled>
        </td>
        <td class="px-6 py-4 whitespace-nowrap" th:text="${todo.createdAt}"></td>
        <td class="px-6 py-4 whitespace-nowrap">
            <a th:href="@{/todo/edit/{id}(id=${todo.id})}" class="text-indigo-600 hover:text-indigo-900 inline-block mr-2">Edit</a>
            <span>|</span>
            <form action="/todo/delete/{id}" method="post" th:action="@{/todo/delete/{id}(id=${todo.id})}" class="inline-block">
                <button type="submit" class="text-red-600 hover:text-red-900">Delete</button>
            </form>
        </td>
    </tr>
    </tbody>
</table>
</body>
</html>
